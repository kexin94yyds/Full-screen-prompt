# Prompter - 故障排除速查卡 🚀

> 快速解决常见问题的参考卡片

---

## 🔥 最常见问题

### 问题 1: 插入功能不工作 (错误 1002)

**快速诊断：**
```bash
# 检查是哪个应用在运行
ps aux | grep -E "Prompter|mac-arm64" | grep -v grep
```

**快速修复：**
```bash
# 1. 停止旧应用
killall Prompter 2>/dev/null

# 2. 启动正确的应用
open "dist/mac-arm64/Prompter.app"

# 3. 打开辅助功能设置
open "x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility"
```

**然后：** 在辅助功能中勾选 "Prompter"

📖 [详细解决方案](./问题排除手册.md#1-辅助功能权限问题-错误-1002)

---

### 问题 2: 改名后应用不工作

**症状：** 修改应用名称后，插入功能失效

**快速修复：**
```bash
# 1. 停止所有旧进程
killall "旧应用名" 2>/dev/null
killall "新应用名" 2>/dev/null

# 2. 重新打包
npm run build

# 3. 启动新应用
./启动应用.sh
```

**关键：** 必须重新给新应用授权辅助功能

📖 [详细解决方案](./问题排除手册.md#3-应用改名后插入功能失效)

---

### 问题 3: 窗口不显示

**快速检查：**
```bash
# 应用是否在运行？
ps aux | grep Prompter | grep -v grep

# 如果没有输出，启动应用
open "dist/mac-arm64/Prompter.app"
```

**快捷键：** `Shift + ⌘ + O`

---

## 📋 常用命令

### 应用管理

```bash
# 启动应用
./启动应用.sh

# 或直接打开
open "dist/mac-arm64/Prompter.app"

# 停止应用
killall Prompter

# 检查应用状态
ps aux | grep Prompter | grep -v grep

# 重新打包
npm run build
```

### 权限管理

```bash
# 打开辅助功能设置
open "x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility"

# 测试辅助功能权限
osascript -e 'tell application "System Events" to keystroke "test"'
```

### 调试

```bash
# 查看所有 Electron 应用
ps aux | grep -i electron | grep -v grep

# 查看应用日志（从终端启动时）
npm start

# 检查应用文件
ls -la dist/mac-arm64/
```

---

## 🎯 决策树

```
应用有问题？
  ↓
能呼出窗口吗？(Shift+⌘+O)
  ├─ 否 → 应用是否在运行？
  │      ├─ 否 → 启动应用
  │      └─ 是 → 检查快捷键冲突
  └─ 是 ↓
       插入功能工作吗？(按Enter)
       ├─ 否 → 检查辅助功能权限
       │      └─ 是否勾选Prompter？
       │         ├─ 否 → 添加并勾选
       │         └─ 是 → 检查运行的是否是正确版本
       └─ 是 → ✅ 一切正常！
```

---

## 🔧 紧急修复流程

**当一切都不工作时，从头开始：**

```bash
# 1. 完全清理
killall Prompter 2>/dev/null
killall "提示词库" 2>/dev/null
rm -rf dist/

# 2. 重新打包
npm run build

# 3. 启动应用
open "dist/mac-arm64/Prompter.app"

# 4. 授权辅助功能
open "x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility"
# 添加 Prompter.app 并勾选

# 5. 测试
# 按 Shift+⌘+O 呼出窗口
# 选择提示词，按 Enter
```

---

## 📞 问题仍未解决？

### 检查清单：

- [ ] 应用正在运行且是正确版本
- [ ] 系统设置中 "Prompter" 已勾选
- [ ] 没有其他应用占用快捷键 `Shift+⌘+O`
- [ ] 应用文件完整存在于 `dist/mac-arm64/`
- [ ] macOS 版本兼容 (推荐 12.0+)

### 获取详细帮助：

📖 **完整文档：** [问题排除手册.md](./问题排除手册.md)  
📖 **快速开始：** [快速开始指南.md](./快速开始指南.md)  
📖 **使用说明：** [README-MAC-APP.md](./README-MAC-APP.md)

---

## 💡 专业提示

1. **日常使用：** 使用 `./启动应用.sh` 脚本启动，最稳定
2. **修改代码后：** 记得运行 `npm run build` 重新打包
3. **改应用名后：** 必须停止旧进程 + 重新授权辅助功能
4. **开发调试：** 用 `npm start` 查看实时日志
5. **生产使用：** 用打包好的 `.app` 文件，不依赖终端

---

**提示：** 把这个文件加入书签，遇到问题时快速查找！

**最后更新：** 2025-10-29


